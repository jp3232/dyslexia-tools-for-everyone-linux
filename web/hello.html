<!DOCTYPE html>
<html>
    <head>

        <title>Accessibility</title>
        <link rel="stylesheet" type="text/css" href="main.css">
        <!-- Include eel.js - note this file doesn't exist in the 'web' directory -->
        <script type="text/javascript" src="/eel.js"></script>
        <script type="text/javascript">
        
        eel.text_to_keys("javascript to python is working");  // Call a Python function
        
        </script>
    </head>
    
    <body>


      <div id="mic-ui" class="off" onclick="mic_click()"> 
        <img id="mic-icon" class="mic" src="off.svg">
      </div>
      <svg xmlns="http://www.w3.org/2000/svg"  id="speaker-icon"  onclick="speaker_click()"  class="say" viewBox="0 0 24 24" fill="black" width="48px" height="48px"><path d="M3 10v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71V6.41c0-.89-1.08-1.34-1.71-.71L7 9H4c-.55 0-1 .45-1 1zm13.5 2c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 4.45v.2c0 .38.25.71.6.85C17.18 6.53 19 9.06 19 12s-1.82 5.47-4.4 6.5c-.36.14-.6.47-.6.85v.2c0 .63.63 1.07 1.21.85C18.6 19.11 21 15.84 21 12s-2.4-7.11-5.79-8.4c-.58-.23-1.21.22-1.21.85z"/></svg>

      <svg class="info" onclick="info()" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="48px" height="48px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/></svg>      </div>
      <script>
//////////////////////////////////// info 

function info(){
  window.open("info.html", "", "width=350,height=250"); 
  }



///////////////////////////////////// text to spech 
/*

      <img id="speaker-icon"  onclick="speaker_click()"  class="say" src="say.svg">



eel.expose(store_this_text);               // Expose this function to Python
                    function store_this_text(x) {
                    text = x;  
                    console.log(text);
                    }

function say(){
   eel.get_text();
   console.log(text);
   //var msg = new SpeechSynthesisUtterance(text);
   //  window.speechSynthesis.speak(msg);
  
   var msg = new SpeechSynthesisUtterance();
var voices = window.speechSynthesis.getVoices();
msg.volume = 1; // 0 to 1
msg.rate = 1; // 0.1 to 10
msg.pitch = 0; //0 to 2
msg.text = text;



speechSynthesis.speak(msg);
   }
*/

    var    speaker_state = "start";
    function speaker_click(){
  say()
      /*
      if (speaker_state == "stop") {
        tag = '<svg xmlns="http://www.w3.org/2000/svg" id="speaker-icon"  onclick="speaker_click()"  class="say" viewBox="0 0 24 24" fill="black" width="48px" height="48px"><path d="M3 10v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71V6.41c0-.89-1.08-1.34-1.71-.71L7 9H4c-.55 0-1 .45-1 1zm13.5 2c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 4.45v.2c0 .38.25.71.6.85C17.18 6.53 19 9.06 19 12s-1.82 5.47-4.4 6.5c-.36.14-.6.47-.6.85v.2c0 .63.63 1.07 1.21.85C18.6 19.11 21 15.84 21 12s-2.4-7.11-5.79-8.4c-.58-.23-1.21.22-1.21.85z"/></svg>';
        var Obj = document.getElementById('speaker-icon'); 
        Obj.outerHTML=tag
        speaker_state = "start"
  //      document.getElementalsoById("speaker-icon").src='say.svg';
              } 

      if(speaker_state == "start"){
        tag = '<svg xmlns="http://www.w3.org/2000/svg"  id="speaker-icon"  onclick="speaker_click()"  class="say" viewBox="0 0 24 24" fill="black" width="48px" height="48px"><path d="M3 10v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71V6.41c0-.89-1.08-1.34-1.71-.71L7 9H4c-.55 0-1 .45-1 1zm13.5 2c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 4.45v.2c0 .38.25.71.6.85C17.18 6.53 19 9.06 19 12s-1.82 5.47-4.4 6.5c-.36.14-.6.47-.6.85v.2c0 .63.63 1.07 1.21.85C18.6 19.11 21 15.84 21 12s-2.4-7.11-5.79-8.4c-.58-.23-1.21.22-1.21.85z"/></svg>';
        var Obj = document.getElementById('speaker-icon'); 
        Obj.outerHTML=tag
        speaker_state = "stop"
        //document.getElementById("speaker-icon").src='stop.svg';
         
        }
   */     
    }

function say(){
eel.get_text();
//var say_output = new Audio('TTS.mp3');
//say_output.play()
new Audio('TTS.mp3').play();
}
      
///////////////////////////////////// spech to text 

//        const button = document.getElementById("button");
    var on = new Audio('on.wav');
    var off = new Audio('off.wav');

    var    mic_state = "stop";
    function mic_click(){
      
      if(mic_state == "start"){
         mic_state = "stop"
         recognition.stop();
         document.getElementById("mic-ui").className = "off";
         document.getElementById("mic-icon").src='off.svg';
         off.play();
 
      }
      if(mic_state == "stop"){
        mic_state = "start"
        recognition.start();
        document.getElementById("mic-ui").className = "on"; 
        document.getElementById("mic-icon").src='on.svg';
        on.play();
       

      }
        
      }


        window.SpeechRecognition = window.webkitSpeechRecognition || window.SpeechRecognition;
        let finalTranscript = '';
        let recognition = new window.SpeechRecognition();
    
        recognition.interimResults = true;
        recognition.maxAlternatives = 10;
        recognition.continuous = true;
    
        recognition.onresult = (event) => {
          let interimTranscript = '';
          for (let i = event.resultIndex, len = event.results.length; i < len; i++) {
            let transcript = event.results[i][0].transcript;
            if (event.results[i].isFinal) {
              finalTranscript += transcript;
              eel.text_to_keys(transcript.replace("'","-")); ///////////////////////// eel
            } else {
              interimTranscript += transcript;
            }
          }
    
        //  document.querySelector('body').innerHTML = finalTranscript + '<i style="color:#ddd;">' + interimTranscript + '</>';
        }
      //  recognition.start();
        

      </script>
      </body>
</html>